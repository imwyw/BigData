<!-- TOC -->

- [环境](#环境)
  - [网络配置](#网络配置)
    - [hosts设置](#hosts设置)
    - [network设置](#network设置)
    - [ip地址配置](#ip地址配置)
    - [关闭防火墙](#关闭防火墙)
    - [关闭SElinux](#关闭selinux)
    - [测试连通](#测试连通)
    - [DNS配置](#dns配置)
    - [物理主机host](#物理主机host)
    - [其他-物理主机虚拟网卡](#其他-物理主机虚拟网卡)
  - [时间同步及JDK](#时间同步及jdk)
    - [更改yum源](#更改yum源)
    - [时钟同步](#时钟同步)
    - [安装JDK](#安装jdk)
  - [相关服务](#相关服务)

<!-- /TOC -->

<a id="markdown-环境" name="环境"></a>
# 环境

基本环境：

- VMware 15，虚拟机虚拟网卡设置为主机模式
- CentOS 7

机器名 | IP | 备注
----|----|---
master | 192.168.217.150 | 主节点 centos 7
node001 | 192.168.217.151 | 子节点 centos 7

注意此处`192.168.217.x`217段是随机生成，并不是特殊设置，当然也可以通过【vmnetcfg.exe】进行修改调整。

<a id="markdown-网络配置" name="网络配置"></a>
## 网络配置

下面以主节点`master`的配置为例说明，子节点`node001`的配置类似。

在终端中输入命令 `ifconfig` 观察ip配置：

```shell
ifconfig
```

针对centos7+有所区分，命令：`ip addr`

```shell
[root@master ~]# ip addr
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host 
       valid_lft forever preferred_lft forever
2: ens33: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP group default qlen 1000
    link/ether 00:0c:29:1e:6a:79 brd ff:ff:ff:ff:ff:ff
    inet 192.168.217.150/24 brd 192.168.217.255 scope global noprefixroute ens33
       valid_lft forever preferred_lft forever
    inet6 fe80::9cea:c941:7028:1842/64 scope link tentative noprefixroute dadfailed 
       valid_lft forever preferred_lft forever
    inet6 fe80::ad86:a254:275d:afaa/64 scope link noprefixroute 
       valid_lft forever preferred_lft forever

```

<a id="markdown-hosts设置" name="hosts设置"></a>
### hosts设置

linux主机名的相关配置文件就是`/etc/hosts`

这个文件告诉主机那些域名对应那些ip,哪些主机名对应哪些ip， `vi` 命令修改【hosts】文件

```shell
[root@localhost ~]# vi /etc/hosts
```

添加内容如下：

```shell
127.0.0.1   loc
192.168.217.150 master
192.168.217.151 node001
```

<a id="markdown-network设置" name="network设置"></a>
### network设置
进行网络配置：

```shell
[root@localhost ~]# vi /etc/sysconfig/network
```

修改主机名称：

```shell
NETWORKING=yes
HOSTNAME=master
```

<a id="markdown-ip地址配置" name="ip地址配置"></a>
### ip地址配置

centos6+进行IP地址的配置：
```shell
[root@localhost ~]# vi /etc/sysconfig/network-scripts/ifcfg-eth0 
```

```shell
[root@localhost ~]# vi /etc/sysconfig/network-scripts/ifcfg-ens33
```

修改内容如下：

```shell
DEVICE="eth0"
BOOTPROTO="static"
HWADDR="00:0C:29:E0:C0:CB"
IPV6INIT="yes"
NM_CONTROLLED="yes"
ONBOOT="yes"
TYPE="Ethernet"
UUID="5865aa15-b660-4552-9bd9-68ee612fc9ff"
IPADDR=192.168.217.150
NETMASK=255.255.255.0
GATEWAY=192.168.217.2
DNS1=192.168.217.2
DNS2=114.114.114.114
```

修改 `BOOTPROTO` 为静态 `static` ，并设置 `IPADDR` , `NETMASK` , `GATEWAY` 

<a id="markdown-关闭防火墙" name="关闭防火墙"></a>
### 关闭防火墙
```shell
centos7
[root@localhost ~]# systemctl disable firewalld.service
[root@localhost ~]# systemctl stop firewalld.service

centos6
$ chkconfig iptables off
$ service iptables stop
$ chkconfig --list iptables
```

<a id="markdown-关闭selinux" name="关闭selinux"></a>
### 关闭SElinux

```shell
vi /etc/sysconfig/selinux
```

将`SELINUX=enforcing`改为`SELINUX=disabled`

```shell
# This file controls the state of SELinux on the system.
# SELINUX= can take one of these three values:
#     enforcing - SELinux security policy is enforced.
#     permissive - SELinux prints warnings instead of enforcing.
#     disabled - No SELinux policy is loaded.
SELINUX=disabled
# SELINUXTYPE= can take one of three values:
#     targeted - Targeted processes are protected,
#     minimum - Modification of targeted policy. Only selected processes are protected.
#     mls - Multi Level Security protection.
SELINUXTYPE=targeted
```

<a id="markdown-测试连通" name="测试连通"></a>
### 测试连通

完成以上设置后，重启虚拟机。

```shell
reboot
```

重启后，可在linux中使用 `ping` 命令测试与物理主机的连通。

```shell
ping 192.168.217.1
```

同样，也可以 ping 命令测试虚拟机IP和主机名是否生效：

```shell
ping master
ping 192.168.217.150
```

<a id="markdown-dns配置" name="dns配置"></a>
### DNS配置

```shell
vi /etc/resolv.conf
```

<a id="markdown-物理主机host" name="物理主机host"></a>
### 物理主机host
可以通过设置物理主机的host文件，通过主机名进行 ping 

默认路径为【C:\Windows\System32\drivers\etc\hosts】，新增如下配置：

```shell
# master
192.168.217.150 master
```

在物理主机命令提示符中，即可通过虚拟主机名进行通信：

```shell
C:\Users\xxxxx>ping master

正在 Ping master [192.168.217.150] 具有 32 字节的数据:
来自 192.168.217.150 的回复: 字节=32 时间<1ms TTL=64
来自 192.168.217.150 的回复: 字节=32 时间<1ms TTL=64
来自 192.168.217.150 的回复: 字节=32 时间<1ms TTL=64
来自 192.168.217.150 的回复: 字节=32 时间<1ms TTL=64
```

注意，修改hosts文件需要有管理员权限！

<a id="markdown-其他-物理主机虚拟网卡" name="其他-物理主机虚拟网卡"></a>
### 其他-物理主机虚拟网卡

虚拟机网卡为“主机”模式，虚拟主机网卡与物理主机【VMware Network Adapter VMnet1】网卡为同一网段，即可以通讯。

在物理主机中，可以通过在命令提示符中输入： `ipconfig` 命令，观察 VMnet1 网卡的IP地址；

或者在VMware安装路径下【vmnetcfg.exe】程序中找到主机模式下的IP地址。

<a id="markdown-时间同步及jdk" name="时间同步及jdk"></a>
## 时间同步及JDK
<a id="markdown-更改yum源" name="更改yum源"></a>
### 更改yum源

```shell
#备份原镜像
[root@localhost ~]# mv /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.backup
[root@localhost ~]# cd /etc/yum.repos.d/

#centos 7 
[root@localhost yum.repos.d]# wget http://mirrors.163.com/.help/CentOS7-Base-163.repo
#centos 6 
[root@localhost yum.repos.d]# wget http://mirrors.163.com/.help/CentOS6-Base-163.repo
#------------------------#
[root@localhost yum.repos.d]# yum clean all
[root@localhost yum.repos.d]# yum makecache
```

<a id="markdown-时钟同步" name="时钟同步"></a>
### 时钟同步

```shell
# 安装同步服务
[root@localhost ~] yum install -y ntp
# 查看服务是否已运行
[root@localhost ~] systemctl | grep ntpd
[root@localhost ~] systemctl is-enabled ntpd
[root@localhost ~] systemctl enable ntpd
[root@localhost ~] systemctl start ntpd
```

<a id="markdown-安装jdk" name="安装jdk"></a>
### 安装JDK

如果原本环境中已有jdk，但并非是目标版本则需要卸载之

```shell
yum remove *openjdk*
```

安装oracle JDK1.8

```shell
[root@localhost ~]# cd /usr/local
[root@localhost local]# mkdir jdk8
```

复制下载好的linux版JDK1.8到 `/usr/local/jdk8`目录，上传工具可以选择 `yum -y install lrzsz`

```shell
[root@localhost local]# cd jdk8
[root@master jdk8]# tar -zxvf jdk-8u151-linux-x64.tar.gz 
```

配置jdk环境变量

```shell
[root@master jdk8]# vim /etc/profile
#java
export JAVA_HOME=/usr/local/jdk8/jdk1.8.0_151
export JRE_HOME=$JAVA_HOME/jre
export CLASSPATH=.:$JAVA_HOME/lib:$JRE_HOME/lib
export PATH=$PATH:$JAVA_HOME/bin
```

使环境变量生效

```shell
[root@master jdk8]# source /etc/profile
```

<a id="markdown-相关服务" name="相关服务"></a>
## 相关服务

```shell
#设定用户所创建目录的初始权限
umask 0022

yum -y install lrzsz

yum install -y openssh-clients
```






